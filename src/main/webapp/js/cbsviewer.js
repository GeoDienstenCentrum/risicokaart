OpenLayers.Handler.KeyboardPoint=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown"],initialize:function(c,b,a){OpenLayers.Handler.prototype.initialize.apply(this,arguments);this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments)){return false}this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,{styleMap:new OpenLayers.StyleMap({externalGraphic:"img/info.png",graphicHeight:40,graphicWidth:32,graphicXOffset:-16,graphicYOffset:-36})});this.map.addLayer(this.layer);this.observeElement=this.observeElement||document;for(var b=0,a=this.KEY_EVENTS.length;b<a;b++){OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[b],this.eventListener)}if(!this.point){this.createFeature()}return true},deactivate:function(){if(!OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){return false}for(var b=0,a=this.KEY_EVENTS.length;b<a;b++){OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[b],this.eventListener)}this.map.removeLayer(this.layer);this.destroyFeature();return true},handleKeyEvent:function(a){switch(a.keyCode){case OpenLayers.Event.KEY_LEFT:this.modifyFeature(-3,0);break;case OpenLayers.Event.KEY_RIGHT:this.modifyFeature(3,0);break;case OpenLayers.Event.KEY_UP:this.modifyFeature(0,3);break;case OpenLayers.Event.KEY_DOWN:this.modifyFeature(0,-3);break;case OpenLayers.Event.KEY_RETURN:this.callback("done",[this.point.geometry.clone()]);break;case OpenLayers.Event.KEY_ESC:this.callback("cancel");break}},modifyFeature:function(c,b){if(!this.point){this.createFeature()}var a=this.map.getResolution();this.point.geometry.x=this.point.geometry.x+c*a;this.point.geometry.y=this.point.geometry.y+b*a;this.callback("modify",[this.point.geometry,this.point,false]);this.point.geometry.clearBounds();this.drawFeature()},createFeature:function(){var a=this.map.getCenter();var b=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(b);this.callback("create",[this.point.geometry,this.point]);this.point.geometry.clearBounds();this.layer.addFeatures([this.point],{silent:true})},destroyFeature:function(){this.layer.destroyFeatures([this.point]);this.point=null},drawFeature:function(){this.layer.drawFeature(this.point)},CLASS_NAME:"OpenLayers.Handler.KeyboardPoint"});OpenLayers.Control.KeyboardClick=OpenLayers.Class(OpenLayers.Control,{initialize:function(a){OpenLayers.Control.prototype.initialize.apply(this,[a]);var b=this.observeElement||document;this.handler=new OpenLayers.Handler.KeyboardPoint(this,{done:this.onClick,cancel:this.deactivate},{observeElement:b});OpenLayers.Event.observe(b,"keydown",OpenLayers.Function.bindAsEventListener(function(c){if(c.keyCode==73){if(this.active){this.deactivate()}else{this.activate()}}},this))},onClick:function(d){var a=this.map.getControlsByClass("WMSGetFeatureInfo")[0];if(a){var c=new OpenLayers.LonLat([d.x,d.y]);var b=this.map.getPixelFromLonLat(c);a.getInfoForClick({xy:b,lonlat:c})}},activate:function(){if(!OpenLayers.Control.prototype.activate.apply(this,arguments)){return false}var a=this.map.getControlsByClass("OpenLayers.Control.KeyboardDefaults")[0];if(a){a.deactivate()}var b=this.map.getControlsByClass("ClickDrawControl")[0];if(b){b.deactivate()}return true},deactivate:function(){if(!OpenLayers.Control.prototype.deactivate.apply(this,arguments)){return false}var a=this.map.getControlsByClass("OpenLayers.Control.KeyboardDefaults")[0];if(a){a.activate()}var b=this.map.getControlsByClass("ClickDrawControl")[0];if(b){b.activate()}return true},CLASS_NAME:"OpenLayers.Control.KeyboardClick"});WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control.WMSGetFeatureInfo,{queryVisible:true,maxFeatures:20,infoFormat:"text/html",autoActivate:true,initialize:function(a){a=a||{};a.handlerOptions=a.handlerOptions||{};OpenLayers.Control.WMSGetFeatureInfo.prototype.initialize.apply(this,[a])},CLASS_NAME:"WMSGetFeatureInfo"});UpdateLegendControl=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,element:null,destroy:function(){this.deactivate();OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){this.map.events.register("addlayer",this,this.redraw);this.redraw();return true}else{return false}},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.map.events.unregister("addlayer",this,this.redraw);this.element.innerHTML="";return true}else{return false}},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(!this.element){this.div.left="";this.div.top="";this.element=this.div}return this.div},redraw:function(c){if(c==null){this.reset();return}else{if(c.layer.CLASS_NAME=="OpenLayers.Layer.WMS"){var e=c.layer;var b=(e.params.LAYERS).split(",");var f=(e.params.STYLES).split(",");var d="";for(i=0,l=b.length;i<l;i++){var a=e.url+"?SERVICE=WMS&REQUEST=GetLegendGraphic&FORMAT=image%2Fpng&WIDTH=36&HEIGHT=36&LAYER="+b[i]+"&STYLE="+f[i]+"&VERSION=1.1.1&EXCEPTIONS="+e.params.EXCEPTIONS;d+='<img src="'+a+'" alt="Legenda voor kaartlaag '+e.name+" ("+b[i]+')"/>'}if(d!=this.element.innerHTML){this.element.innerHTML=d}}}},reset:function(a){if(this.emptyString!==null){this.element.innerHTML=this.emptyString}},CLASS_NAME:"UpdateLegendControl"});ClickDrawControl=OpenLayers.Class(OpenLayers.Control,{autoActivate:true,defaultHandlerOptions:{single:true,"double":false,pixelTolerance:0,stopSingle:false,stopDouble:false},initialize:function(a){this.handlerOptions=OpenLayers.Util.extend({},this.defaultHandlerOptions);OpenLayers.Control.prototype.initialize.apply(this,arguments);this.handler=new OpenLayers.Handler.Click(this,{click:this.trigger},this.handlerOptions)},trigger:function(a){if(!this.layer){this.makeLayer()}this.drawOrMove(a)},makeLayer:function(){this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,{styleMap:new OpenLayers.StyleMap({externalGraphic:"img/info.png",graphicHeight:40,graphicWidth:32,graphicXOffset:-16,graphicYOffset:-36})});this.map.addLayer(this.layer)},drawOrMove:function(b){this.map.setLayerIndex(this.layer,this.map.getNumLayers()-1);var a=this.map.getLonLatFromPixel(b.xy);if(!this.point){var c=new OpenLayers.Geometry.Point(a.lon,a.lat);this.point=new OpenLayers.Feature.Vector(c);this.point.geometry.clearBounds();this.layer.addFeatures([this.point],{silent:true})}else{this.point.geometry.x=a.lon;this.point.geometry.y=a.lat;this.point.geometry.clearBounds()}this.layer.drawFeature(this.point)},activate:function(){if(!OpenLayers.Control.prototype.activate.apply(this,arguments)){return false}return true},deactivate:function(){if(!OpenLayers.Control.prototype.deactivate.apply(this,arguments)){return false}if(this.layer){this.map.removeLayer(this.layer);this.layer.destroyFeatures([this.point]);this.point=null;this.layer=null}return true},CLASS_NAME:"ClickDrawControl"});ZoomControl=OpenLayers.Class(OpenLayers.Control.Zoom,{getOrCreateLinks:function(b){var d=document.getElementById(this.zoomInId),a=document.getElementById(this.zoomOutId);if(!d){d=document.createElement("button");d.href="#zoomIn";var c=document.createElement("span");c.appendChild(document.createTextNode(OpenLayers.i18n("KEY_ZOOMIN_TOOLTIP")));d.appendChild(c);d.appendChild(document.createTextNode(this.zoomInText));d.className="olControlZoomIn";b.appendChild(d)}OpenLayers.Element.addClass(d,"olButton");OpenLayers.Element.addClass(d,"hasTooltip");if(!a){a=document.createElement("button");a.href="#zoomOut";var c=document.createElement("span");c.appendChild(document.createTextNode(OpenLayers.i18n("KEY_ZOOMOUT_TOOLTIP")));a.appendChild(c);a.appendChild(document.createTextNode(this.zoomOutText));a.className="olControlZoomOut";b.appendChild(a)}OpenLayers.Element.addClass(a,"olButton");OpenLayers.Element.addClass(a,"hasTooltip");return{zoomIn:d,zoomOut:a}},CLASS_NAME:"ZoomControl"});OverviewMap=OpenLayers.Class(OpenLayers.Control.OverviewMap,{maximized:true,mapOptions:{theme:null},size:{w:140,h:140},autoPan:true,initialize:function(a){this.layers=[];this.handlers={};OpenLayers.Control.prototype.initialize.apply(this,[a])},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments);if(this.layers.length===0){if(this.map.baseLayer){var b=this.map.baseLayer.clone();this.layers=[b]}else{this.map.events.register("changebaselayer",this,this.baseLayerDraw);return this.div}}this.element=document.createElement("div");this.element.className=this.displayClass+"Element";this.element.style.display="none";this.mapDiv=document.createElement("div");this.mapDiv.style.width=this.size.w+"px";this.mapDiv.style.height=this.size.h+"px";this.mapDiv.style.position="relative";this.mapDiv.style.overflow="hidden";this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap");this.extentRectangle=document.createElement("div");this.extentRectangle.style.position="absolute";this.extentRectangle.style.zIndex=1000;this.extentRectangle.className=this.displayClass+"ExtentRectangle";this.element.appendChild(this.mapDiv);this.div.appendChild(this.element);this.div.className+=" "+this.displayClass+"Container";var a=document.createElement("button");a.innerHTML="<span>"+OpenLayers.i18n("KEY_TOGGLE_OVERVIEW_ON")+'</span><img src="img/maximize.png" alt="tonen"/>';a.name="tonen";this.maximizeDiv=a;this.maximizeDiv.style.display="none";this.maximizeDiv.className=this.displayClass+"MaximizeButton overviewMapButton olButton hasTooltip";this.div.appendChild(this.maximizeDiv);a=document.createElement("button");a.innerHTML="<span>"+OpenLayers.i18n("KEY_TOGGLE_OVERVIEW_OFF")+'</span><img src="img/minimize.png" alt="verbergen"/>';a.name="verbergen";this.minimizeDiv=a;this.minimizeDiv.style.display="none";this.minimizeDiv.className=this.displayClass+"MinimizeButton overviewMapButton olButton hasTooltip";this.div.appendChild(this.minimizeDiv);this.minimizeControl();if(this.map.getExtent()){this.update()}this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this});if(this.maximized){this.maximizeControl()}return this.div},CLASS_NAME:"OverviewMap"});var Viewer=function(){var h=null;var c=false;var b=false;var a=0.8;function e(i){if(i.text!==undefined){jQuery("#"+config.featureInfoDiv).html(i.text);jQuery("#"+config.featureInfoDiv).change()}}function f(){if(c){var j=parseInt(jQuery("#"+this.config.mapDiv).css("borderLeftWidth"),10)+parseInt(jQuery("#"+this.config.mapDiv).css("borderRightWidth"),10);var o=parseInt(jQuery("#"+this.config.mapDiv).css("borderTopWidth"),10)+parseInt(jQuery("#"+this.config.mapDiv).css("borderBottomWidth"),10);var p=parseInt(jQuery("#"+this.config.mapDiv).parent().parent().css("padding-top"),10);var n=parseInt(jQuery("#"+this.config.mapDiv).parent().parent().css("padding-bottom"),10);var i=jQuery("#"+this.config.mapDiv).parent().width()-j;var k=jQuery(window).height()-p-n-o;jQuery("#"+this.config.mapDiv).width(i).height(k);jQuery("#legenda").css("max-height",jQuery(window).height()-500);h.updateSize();var m=h.getLayersByClass("OpenLayers.Layer.Vector");if(m.length>0){var l=m[0].getDataExtent();h.panTo(l.getCenterLonLat())}}}function d(k){k=parseFloat(k);if(0.09<k&&k<0.91){a=k;var j=h.getLayersByClass("OpenLayers.Layer.WMS");for(var i=0;i<j.length;i++){if(!j[i].isBaseLayer){j[i].setOpacity(a)}}}}function g(i){h.getControlsByClass("ClickDrawControl")[0].trigger({xy:h.getPixelFromLonLat(i)});h.getControlsByClass("WMSGetFeatureInfo")[0].deactivate();h.getControlsByClass("WMSGetFeatureInfo")[0].activate();h.events.triggerEvent("click",{xy:h.getPixelFromLonLat(i)});h.events.unregister("zoomend",h,g)}return{init:function(i){this.config=i;OpenLayers.ImgPath=i.imgPath;OpenLayers.IMAGE_RELOAD_ATTEMPTS=2;OpenLayers.Number.decimalSeparator=",";jQuery.extend(true,this.config,{map:{controls:[],theme:null}});jQuery(window).unload(function(){Viewer.destroy()});jQuery("#"+this.config.mapDiv).width(this.config.map.width).height(this.config.map.height);h=new OpenLayers.Map(this.config.mapDiv,this.config.map);this.addBaseMap();this.addControls();h.zoomTo(this.config.map.initialZoom);var l='<a class="lufo hasTooltip" href="#" id="toggleBaseMap" onclick="Viewer.toggleBaseMap();"><span>'+OpenLayers.i18n("KEY_TOGGLE_BASEMAP_TITLE")+"</span>"+OpenLayers.i18n("KEY_TOGGLE_BASEMAP_LUFO")+"</a>";jQuery("#"+i.mapDiv).prepend(l);if(this.config.toggleSize){var k='<a class="max hasTooltip" href="#" id="toggleSize" onclick="Viewer.toggleFullSize();"><span>'+OpenLayers.i18n("KEY_TOGGLE_SIZE")+"</span></a>";jQuery("#"+i.mapDiv).prepend(k)}if(this.config.fullSize){this.toggleFullSize()}jQuery(window).resize(function(){if(b){clearTimeout(b)}b=setTimeout(f,200)});if(this.config.fgAlphaSlider){var j=jQuery('<div id="transparantie" class="transparantieslider"></div>').prependTo(jQuery("#"+i.mapDiv)).slider({value:a*100,range:"min",min:10,max:90,step:10,animate:"slow",slide:function(m,n){d(n.value/100);jQuery(this).find("a:first").text(n.value);jQuery(this).find("a:first").append("<span>"+OpenLayers.i18n("KEY_TRANSP_SLIDER_LABEL",{"0":(100-n.value)})+"</span>");jQuery(this).find("a:first").addClass("hasTooltip")}});jQuery("#transparantie").find("a:first").addClass("hasTooltip");jQuery("#transparantie").find("a:first").text((a*100));jQuery("#transparantie").find("a:first").append("<span>"+OpenLayers.i18n("KEY_TRANSP_SLIDER_LABEL",{"0":(100-(a*100))})+"</span>")}},getMap:function(){(window.console&&console.warn("Deprecated method called: Viewer::getMap()."));return h},zoomTo:function(j,m,i,k){var l=new OpenLayers.LonLat(j,m);h.panTo(l);h.zoomTo(h.getZoomForExtent(new OpenLayers.Bounds(j-i,m-i,j+i,m+i)));if(k){h.events.register("zoomend",h,g(l))}},addControls:function(){h.addControl(new UpdateLegendControl({div:jQuery("#"+this.config.legendDiv)[0]}));h.addControl(new OpenLayers.Control.KeyboardDefaults());h.addControl(new ZoomControl());h.addControl(new OpenLayers.Control.Navigation());h.addControl(new OpenLayers.Control.KeyboardClick());h.addControl(new WMSGetFeatureInfo({eventListeners:{getfeatureinfo:e}}));h.addControl(new ClickDrawControl());h.addControl(new OpenLayers.Control.ScaleLine({maxWidth:200,bottomOutUnits:""}));h.addControl(new OverviewMap({mapOptions:{maxExtent:this.config.map.restrictedExtent,resolutions:this.config.map.resolutions,projection:this.config.map.projection}}))},destroy:function(){if(h!==null){h.destroy();h=null}},setOpacity:function(i){d(i)},loadWMS:function(j){this.removeOverlays();var i=new OpenLayers.Layer.WMS(j.name,j.url,{layers:j.layers,styles:j.styles,version:"1.1.1",format:"image/png",transparent:true},{isBaseLayer:false,visibility:true,singleTile:false,opacity:a});if(j.hasOwnProperty("zoom")){if(h.getZoom()<parseInt(j.zoom)){h.zoomTo(j.zoom)}}h.addLayer(i);var k=h.getControlsByClass("WMSGetFeatureInfo");k[0].url=j.url},removeWMS:function(i){var k=h.getLayersByName(i);for(var j=0;j<k.length;j++){if(!k[j].isBaseLayer){h.removeLayer(k[j]);k[j].destroy()}}},removeOverlays:function(){jQuery("#"+config.featureInfoDiv).html(OpenLayers.i18n("KEY_INFO_GEEN_FEATURES"));var j=h.getLayersByName("ClickDrawControl"),i;for(i=0;i<j.length;i++){j[i].removeAllFeatures()}j=h.getLayersByName("OpenLayers.Handler.KeyboardPoint");for(i=0;i<j.length;i++){j[i].removeAllFeatures()}j=h.getLayersByClass("OpenLayers.Layer.WMS");for(i=0;i<j.length;i++){if(!j[i].isBaseLayer){h.removeLayer(j[i]);j[i].destroy()}}},toggleFullSize:function(){if(c){jQuery("#"+this.config.mapDiv).width(this.config.map.width).height(this.config.map.height);jQuery("#toggleSize").toggleClass("restore max");c=false;h.updateSize();var n=h.getLayersByClass("OpenLayers.Layer.Vector");if(n.length>0){var m=n[0].getDataExtent();h.panTo(m.getCenterLonLat())}}else{var j=parseInt(jQuery("#"+this.config.mapDiv).css("borderLeftWidth"),10)+parseInt(jQuery("#"+this.config.mapDiv).css("borderRightWidth"),10);var o=parseInt(jQuery("#"+this.config.mapDiv).css("borderTopWidth"),10)+parseInt(jQuery("#"+this.config.mapDiv).css("borderBottomWidth"),10);var p=parseInt(jQuery("#"+this.config.mapDiv).parent().parent().css("padding-top"),10);var l=parseInt(jQuery("#"+this.config.mapDiv).parent().parent().css("padding-bottom"),10);var i=jQuery("#"+this.config.mapDiv).parent().width()-j;var k=jQuery(window).height()-p-l-o;jQuery("#"+this.config.mapDiv).width(i).height(k);jQuery("#toggleSize").toggleClass("restore max");c=true;h.updateSize()}},printPrepare:function(){if(c){this.toggleFullSize()}},toggleBaseMap:function(){var i=h.getLayersByName("topo")[0];var j=h.getLayersByName("lufo")[0];if(i.getVisibility()){h.setBaseLayer(j);jQuery("#toggleBaseMap").text(OpenLayers.i18n("KEY_TOGGLE_BASEMAP_TOPO"))}else{h.setBaseLayer(i);jQuery("#toggleBaseMap").text(OpenLayers.i18n("KEY_TOGGLE_BASEMAP_LUFO"))}jQuery("#toggleBaseMap").append("<span>"+OpenLayers.i18n("KEY_TOGGLE_BASEMAP_TITLE")+"</span>");jQuery("#toggleBaseMap").toggleClass("lufo topo")},addBaseMap:function(){h.addLayer(new OpenLayers.Layer.WMTS(jQuery.extend(true,this.config.map.topoWMTS,{name:"topo"})));h.addLayer(new OpenLayers.Layer.WMTS(jQuery.extend(true,this.config.map.aerialWMTS,{name:"lufo"})))}}}();var ZoekFormulier={init:function(a){jQuery("input:image").attr("disabled",true);jQuery("#zoekFormulier").removeAttr("action");jQuery("#zoekFormulier").removeAttr("method");jQuery("#zoekFormulier").find('input[name="coreonly"]').val("false");jQuery("#zoekFormulier").find('input[name="forward"]').val("false");jQuery("#adres").autocomplete({source:function(c,b){jQuery.ajax({url:"adres",data:{adres:c.term,forward:false,format:"json",coreonly:false},dataType:"json"}).success(function(e){var d=jQuery.map(e,function(g,f){return{label:g.addressString,x:g.xCoord,y:g.yCoord,r:g.radius}});b(d)})},select:function(b,c){if(c.item){Viewer.zoomTo(c.item.x,c.item.y,c.item.r,true)}},change:function(b,c){if(!c.item){jQuery(this).val("")}},minLength:4,delay:400,autoFocus:false})}};